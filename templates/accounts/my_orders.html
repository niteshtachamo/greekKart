{% extends "base.html" %}

{% block content %}
<section class="section-conten padding-y bg">
  {% include "includes/alert.html" %}
  <div class="container">
    <div class="row">
      {% include "includes/dashboard_sidebar.html" %}
      <main class="col-md-9">
        <article class="card">
          <header class="card-header">
            <h3 class="d-inline-block mr-3">Your order history</h3>
          </header>
          <div class="card-body">
            <div class="row">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">Orders</th>
                    <th scope="col">Billing Name</th>
                    <th scope="col">Phone Number</th>
                    <th scope="col">Order Total</th>
                    <th scope="col">Order Date</th>
                    <th scope="col">Status</th>
                    {% comment %} <th scope="col">Action</th> {% endcomment %}
                  </tr>
                </thead>
                <tbody>
                  {% for order in orders %}
                  <tr>
                    <th scope="row">
                      <a href="{% url "order_detail" order.order_number %}">{{ order.order_number }}</a>
                    </th>
                    <td>{{ order.full_name }}</td>
                    <td>{{ order.phone }}</td>
                    <td>Rs. {{ order.order_total }}</td>
                    <td>{{ order.created_at|date:"Y-m-d H:i" }}</td>
                    <td>{{ order.status }}</td>
                    {% comment %} <td>
                      <form method="post" action="{% url 'order_delete' order.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this order?');">
                          Delete
                        </button>
                      </form>
                    </td> {% endcomment %}
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="7" class="text-center">No orders found.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>

              <!-- PAGINATION CONTROLS -->
              {% if orders.has_other_pages %}
              <nav aria-label="Order pagination" class="mt-3">
                <ul class="pagination justify-content-center">
                  {% if orders.has_previous %}
                  <li class="page-item">
                    <a class="page-link" href="?page={{ orders.previous_page_number }}" aria-label="Previous">
                      &laquo;
                    </a>
                  </li>
                  {% else %}
                  <li class="page-item disabled">
                    <span class="page-link">&laquo;</span>
                  </li>
                  {% endif %}

                  {% for num in orders.paginator.page_range %}
                    <li class="page-item {% if orders.number == num %}active{% endif %}">
                      <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                    </li>
                  {% endfor %}

                  {% if orders.has_next %}
                  <li class="page-item">
                    <a class="page-link" href="?page={{ orders.next_page_number }}" aria-label="Next">
                      &raquo;
                    </a>
                  </li>
                  {% else %}
                  <li class="page-item disabled">
                    <span class="page-link">&raquo;</span>
                  </li>
                  {% endif %}
                </ul>
              </nav>
              {% endif %}
              <!-- END PAGINATION -->
              
            </div>
          </div>
        </article>
      </main>
    </div>
  </div>
</section>
{% endblock %}
